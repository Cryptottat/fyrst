# FYRST 운영 가이드

---

## 1. 런칭 전 체크리스트

### 1.1 환경 변수 설정

런칭 전에 모든 환경 변수가 프로덕션 값으로 설정되어 있는지 확인합니다.

**백엔드 서비스 (service/.env)**

| 변수 | 설명 | 확인 |
|------|------|------|
| PORT | 서버 포트 (Railway 자동 할당) | [ ] |
| NODE_ENV | `production`으로 설정 | [ ] |
| CORS_ORIGINS | 프로덕션 도메인 (fyrst.xyz) | [ ] |
| SOLANA_RPC_URL | 메인넷 RPC URL | [ ] |
| QUICKNODE_RPC_URL | QuickNode 메인넷 RPC (백업) | [ ] |
| HELIUS_API_KEY | Helius API 키 (DAS API용) | [ ] |
| HELIUS_RPC_URL | Helius RPC 엔드포인트 | [ ] |
| JUPITER_API_URL | Jupiter API URL (https://api.jup.ag) | [ ] |
| DATABASE_URL | PostgreSQL 프로덕션 연결 문자열 | [ ] |
| REDIS_URL | Redis 프로덕션 연결 문자열 | [ ] |
| TELEGRAM_BOT_TOKEN | 텔레그램 모니터링 봇 토큰 | [ ] |
| TELEGRAM_CHAT_ID | 텔레그램 알림 채널 ID | [ ] |

**프론트엔드 (web/.env.local)**

| 변수 | 설명 | 확인 |
|------|------|------|
| NEXT_PUBLIC_API_URL | 백엔드 API 프로덕션 URL | [ ] |
| NEXT_PUBLIC_WS_URL | WebSocket 프로덕션 URL | [ ] |
| NEXT_PUBLIC_SOLANA_RPC | 프론트엔드용 RPC URL | [ ] |
| NEXT_PUBLIC_SITE_URL | 사이트 URL (https://fyrst.xyz) | [ ] |
| NEXT_PUBLIC_TWITTER | 트위터 계정 URL | [ ] |
| NEXT_PUBLIC_GITHUB | GitHub 리포지토리 URL | [ ] |
| NEXT_PUBLIC_TELEGRAM | 텔레그램 채널 URL | [ ] |
| NEXT_PUBLIC_FEATURE_TRADING | `true`로 설정 | [ ] |
| NEXT_PUBLIC_FEATURE_WALLET | `true`로 설정 | [ ] |
| NEXT_PUBLIC_FEATURE_REFUND | `true`로 설정 | [ ] |

### 1.2 DNS 설정

| 항목 | 작업 | 확인 |
|------|------|------|
| fyrst.xyz A/CNAME | Vercel 프로덕션 배포 연결 | [ ] |
| api.fyrst.xyz CNAME | Railway 백엔드 서비스 연결 | [ ] |
| SSL 인증서 | 두 도메인 모두 HTTPS 유효 확인 | [ ] |
| CORS 테스트 | fyrst.xyz에서 api.fyrst.xyz 호출 정상 확인 | [ ] |

### 1.3 데이터베이스 마이그레이션

```bash
# 1. Prisma 스키마 프로덕션 DB에 적용
cd service
npx prisma db push --accept-data-loss

# 2. Prisma Client 생성
npx prisma generate

# 3. 테이블 생성 확인
npx prisma studio
# deployers, tokens, trades, refunds, buyer_records 테이블 존재 확인

# 4. 인덱스 확인 (PostgreSQL 직접 접속)
# tokens: deployer_address, created_at, market_cap
# trades: token_mint, trader_address, created_at
# refunds: token_mint, claimant_address
# buyer_records: buyer_address
```

### 1.4 모니터링 설정

| 항목 | 도구 | 확인 |
|------|------|------|
| 서버 헬스체크 | Railway 헬스체크 (/health 엔드포인트) | [ ] |
| 에러 알림 | 텔레그램 봇 연동 테스트 메시지 전송 | [ ] |
| 웹 분석 | Vercel Analytics 활성화 확인 | [ ] |
| RPC 상태 | Helius/QuickNode 대시보드 접근 확인 | [ ] |
| DB 모니터링 | Railway PostgreSQL 대시보드 확인 | [ ] |
| Redis 모니터링 | Railway Redis 대시보드 확인 | [ ] |
| 업타임 모니터 | 외부 업타임 모니터링 설정 (UptimeRobot 등) | [ ] |

### 1.5 Solana 프로그램 배포

| 항목 | 작업 | 확인 |
|------|------|------|
| Anchor 프로그램 빌드 | `anchor build` 성공 | [ ] |
| 프로그램 ID 확인 | Anchor.toml의 프로그램 ID와 실제 배포 주소 일치 | [ ] |
| 메인넷 배포 | `anchor deploy --provider.cluster mainnet` | [ ] |
| PDA 주소 검증 | 에스크로 PDA, 리펀드 풀 PDA 정상 생성 확인 | [ ] |
| IDL 업로드 | 프로그램 IDL이 온체인에 정상 업로드 | [ ] |
| 프로토콜 지갑 | 프로토콜 수수료 수신 지갑 설정 확인 | [ ] |
| 바이백 지갑 | $FYRST 바이백용 지갑 설정 확인 | [ ] |

### 1.6 보안 체크리스트

| 항목 | 확인 |
|------|------|
| 프로덕션 환경 변수가 코드에 하드코딩되지 않음 | [ ] |
| .env 파일이 .gitignore에 포함 | [ ] |
| Railway 환경 변수가 별도 설정 | [ ] |
| RPC API 키에 rate limit 설정 | [ ] |
| CORS가 프로덕션 도메인만 허용 | [ ] |
| Helmet 미들웨어 활성화 | [ ] |
| 프로그램 업그레이드 권한 지갑 안전 보관 | [ ] |
| 멀티시그 설정 (긴급 동작용) | [ ] |

---

## 2. 런칭일 실행 매뉴얼

### 2.1 배포 순서

런칭일 배포는 아래 순서를 반드시 따릅니다.

**단계 1: Solana 프로그램 최종 확인 (T-4시간)**

```bash
# 메인넷 프로그램 상태 확인
solana program show <PROGRAM_ID> --url mainnet-beta

# 프로그램 데이터 계정 확인
solana account <PROGRAM_ID> --url mainnet-beta
```

**단계 2: 백엔드 배포 (T-3시간)**

```bash
# Railway에서 최신 코드 배포
# Railway 대시보드에서 수동 배포 트리거 또는 main 브랜치 push

# 배포 후 헬스체크
curl https://api.fyrst.xyz/health
# 응답: {"status":"ok"} 확인

# DB 연결 확인
curl https://api.fyrst.xyz/health
# PostgreSQL, Redis 연결 상태 확인
```

**단계 3: 프론트엔드 배포 (T-2시간)**

```bash
# Vercel 프로덕션 배포
# Vercel 대시보드에서 배포 또는 main 브랜치 push

# 빌드 성공 확인
# Vercel 대시보드에서 빌드 로그 확인

# 사이트 접속 테스트
curl -I https://fyrst.xyz
# HTTP 200 확인
```

**단계 4: 통합 테스트 (T-1시간)**

```bash
# API 엔드포인트 테스트
curl https://api.fyrst.xyz/health
curl https://api.fyrst.xyz/api/launches
curl https://api.fyrst.xyz/api/deployer/<test_address>

# WebSocket 연결 테스트
# 브라우저 콘솔에서 WebSocket 연결 확인
```

### 2.2 스모크 테스트 체크리스트

| 테스트 | 방법 | 기대 결과 | 확인 |
|--------|------|-----------|------|
| 사이트 로딩 | fyrst.xyz 접속 | 메인 페이지 정상 렌더링 | [ ] |
| 지갑 연결 | Phantom 지갑 연결 | 지갑 주소 표시 | [ ] |
| 토큰 목록 조회 | 런칭 페이지 접속 | API에서 토큰 목록 로딩 | [ ] |
| 배포자 프로필 | 배포자 주소로 조회 | 평판 점수, 이력 표시 | [ ] |
| 토큰 배포 플로우 | 테스트 토큰 배포 시도 | 에스크로 예치 -> 토큰 생성 확인 | [ ] |
| 거래 플로우 | 테스트 토큰 매수 | 본딩커브 가격 계산 정상, 거래 기록 생성 | [ ] |
| WebSocket 실시간 | 거래 발생 시 | 실시간 가격 업데이트 확인 | [ ] |
| 텔레그램 알림 | 이벤트 트리거 | 텔레그램 채널 알림 수신 | [ ] |

### 2.3 런칭일 모니터링 명령어

```bash
# Railway 로그 실시간 확인 (Railway CLI)
railway logs --tail

# PostgreSQL 연결 수 확인
# Railway 대시보드 -> PostgreSQL -> Metrics

# Redis 메모리 사용량 확인
# Railway 대시보드 -> Redis -> Metrics

# API 응답 시간 확인
curl -o /dev/null -s -w "응답시간: %{time_total}s\n" https://api.fyrst.xyz/health

# 활성 WebSocket 연결 수 확인
curl https://api.fyrst.xyz/health
# 응답에 activeConnections 필드 확인

# Solana 프로그램 트랜잭션 모니터링
# Solscan 또는 Solana Explorer에서 프로그램 ID로 최신 트랜잭션 확인

# 에스크로 총 잔액 확인
# 온체인 조회 또는 내부 대시보드
```

### 2.4 런칭일 일정표

| 시간 (KST) | 작업 | 담당 |
|-------------|------|------|
| 08:00 | 전 팀원 온라인 확인 | 전체 |
| 08:30 | 최종 환경 변수 점검 | 백엔드 |
| 09:00 | Solana 프로그램 최종 확인 | 블록체인 |
| 10:00 | 백엔드 프로덕션 배포 | 백엔드 |
| 10:30 | 백엔드 헬스체크 및 스모크 테스트 | 백엔드 |
| 11:00 | 프론트엔드 프로덕션 배포 | 프론트엔드 |
| 11:30 | 통합 스모크 테스트 | 전체 |
| 12:00 | 기능 플래그 활성화 (TRADING, WALLET, REFUND) | 프론트엔드 |
| 12:30 | 최종 QA 및 결과 공유 | 전체 |
| 13:00 | GO/NO-GO 결정 | 리드 |
| 14:00 (UTC 05:00) | 사이트 공개 | 전체 |
| 14:30 | 트위터 포스트 7 게시 (제품 공개) | 마케팅 |
| 14:30 | 텔레그램/디스코드 런칭 공지 게시 | 마케팅 |
| 15:00~23:00 | 실시간 모니터링 (1시간 간격 상태 체크) | 전체 |
| 23:00 (UTC 14:00) | 트위터 포스트 8 게시 (작동 방식) | 마케팅 |

---

## 3. 일상 운영

### 3.1 일일 점검 항목

매일 오전 09:00 KST에 아래 항목을 점검하고 내부 채널에 공유합니다.

**시스템 상태**

| 점검 항목 | 확인 방법 | 확인 |
|-----------|-----------|------|
| API 서버 정상 작동 | /health 엔드포인트 응답 확인 | [ ] |
| 웹사이트 정상 접속 | fyrst.xyz 로딩 확인 | [ ] |
| WebSocket 연결 정상 | 실시간 데이터 수신 확인 | [ ] |
| PostgreSQL 정상 | Railway 대시보드 상태 확인 | [ ] |
| Redis 정상 | Railway 대시보드 상태 확인 | [ ] |
| Solana RPC 정상 | RPC 응답 시간 확인 (200ms 이하) | [ ] |
| Helius API 정상 | DAS API 응답 확인 | [ ] |

**프로토콜 지표**

| 지표 | 전일 대비 변화 | 확인 |
|------|---------------|------|
| 에스크로 총 담보 (SOL) | | [ ] |
| 신규 토큰 런칭 수 | | [ ] |
| 일일 거래량 (SOL) | | [ ] |
| 활성 사용자 수 (DAU) | | [ ] |
| 신규 배포자 등록 수 | | [ ] |
| 환불 발생 건수 | | [ ] |
| 러그 탐지 건수 | | [ ] |

**마케팅 지표**

| 지표 | 확인 |
|------|------|
| 트위터 팔로워 수 | [ ] |
| 트위터 멘션/리플라이 확인 및 응대 | [ ] |
| 텔레그램/디스코드 메시지 확인 및 응대 | [ ] |
| 예정된 포스트 게시 확인 | [ ] |

### 3.2 주간 리포트 항목

매주 월요일 오전 10:00 KST에 주간 리포트를 작성하여 공유합니다.

**리포트 구조:**

```
FYRST 주간 운영 리포트
기간: [YYYY.MM.DD] ~ [YYYY.MM.DD]

1. 핵심 지표 요약
   - TVL (에스크로 총 담보): [X] SOL (전주 대비 [+/-X]%)
   - 활성 배포자 수: [X]명
   - 총 토큰 런칭 수: [X]개 (신규 [X]개)
   - 주간 거래량: [X] SOL
   - 환불 처리 건수: [X]건 / [X] SOL
   - 러그 탐지율: [X]%
   - DAU 평균: [X]명

2. 배포자 평판 분포
   - A등급: [X]명 ([X]%)
   - B등급: [X]명 ([X]%)
   - C등급: [X]명 ([X]%)
   - D등급: [X]명 ([X]%)
   - F등급: [X]명 ([X]%)

3. 마케팅 지표
   - 트위터 팔로워: [X] (전주 대비 [+/-X])
   - 트위터 인게이지먼트율: [X]%
   - 웹사이트 방문자: [X] (전주 대비 [+/-X]%)
   - 지갑 연결 전환율: [X]%

4. 인시던트 요약
   - 발생 건수: [X]건
   - 해결 건수: [X]건
   - 미해결 건수: [X]건
   - 상세: [각 건별 간략 설명]

5. 다음 주 계획
   - [계획 항목 1]
   - [계획 항목 2]
   - [계획 항목 3]
```

### 3.3 인시던트 대응 프로세스

**심각도 분류**

| 등급 | 정의 | 응답 시간 | 예시 |
|------|------|-----------|------|
| P0 (긴급) | 사용자 자금 영향 또는 프로토콜 전체 중단 | 15분 이내 | 에스크로 취약점, 환불 실패, 서비스 전체 다운 |
| P1 (높음) | 핵심 기능 장애 (거래, 배포 불가) | 1시간 이내 | 거래 기능 장애, RPC 장애, DB 연결 끊김 |
| P2 (보통) | 비핵심 기능 장애 또는 성능 저하 | 4시간 이내 | WebSocket 간헐적 끊김, 느린 API 응답 |
| P3 (낮음) | 미미한 영향, UI 이슈 | 24시간 이내 | 표시 오류, 마이너 UI 버그 |

**인시던트 대응 단계**

1. 탐지: 모니터링 알림 수신 또는 사용자 보고
2. 분류: 심각도 등급 분류 (P0~P3)
3. 알림: 내부 채널에 인시던트 선언 (심각도, 영향 범위, 담당자)
4. 조사: 로그 분석, 원인 파악
5. 대응: 긴급 조치 실행 (상세 내용은 섹션 6 참조)
6. 해결: 정상화 확인
7. 사후 분석: 근본 원인 분석, 재발 방지 대책 수립
8. 문서화: 인시던트 로그 기록

---

## 4. 핵심 추적 지표

### 4.1 TVL (Total Value Locked -- 에스크로 총 담보)

| 항목 | 설명 |
|------|------|
| 정의 | 모든 배포자 에스크로에 잠긴 SOL 총액 |
| 측정 소스 | 온체인 에스크로 PDA 계정 잔액 합산 |
| 모니터링 주기 | 실시간 (대시보드) + 일일 스냅샷 |
| 목표 | D+7: 50 SOL / D+14: 200 SOL / D+30: 1,000 SOL |
| 경고 임계치 | 전일 대비 20% 이상 감소 시 알림 |

### 4.2 활성 배포자 수

| 항목 | 설명 |
|------|------|
| 정의 | 최근 7일 내 토큰을 런칭한 고유 배포자 수 |
| 측정 소스 | deployers 테이블 + tokens 테이블 조인 |
| 모니터링 주기 | 일일 |
| 목표 | D+14: 30명 / D+30: 200명 |

### 4.3 환불율

| 항목 | 설명 |
|------|------|
| 정의 | 환불 트리거 건수 대비 성공적으로 완료된 환불 건수 비율 |
| 측정 소스 | refunds 테이블 (status 필드 기준) |
| 모니터링 주기 | 실시간 (환불 이벤트 발생 시) + 일일 집계 |
| 목표 | 100% (모든 트리거된 환불이 성공) |
| 경고 임계치 | 환불 1건이라도 failed 상태이면 즉시 P0 알림 |

### 4.4 배포자 평판 점수 분포 (DRS Distribution)

| 항목 | 설명 |
|------|------|
| 정의 | A~F 등급별 배포자 수 분포 |
| 측정 소스 | deployers 테이블 reputation_rank 필드 |
| 모니터링 주기 | 주간 |
| 건강 지표 | A+B 등급 비율이 30% 이상이면 건강한 생태계 |
| 경고 임계치 | F등급이 전체 50% 초과 시 러그 방지 전략 재검토 |

### 4.5 러그 탐지율

| 항목 | 설명 |
|------|------|
| 정의 | 실제 러그 이벤트 대비 시스템이 자동 탐지한 비율 |
| 측정 소스 | 온체인 이벤트 + 사용자 보고 비교 분석 |
| 모니터링 주기 | 일일 |
| 목표 | D+14: 95% / D+30: 98% |

### 4.6 프로토콜 수익

| 항목 | 설명 |
|------|------|
| 정의 | 배포 수수료(0.02 SOL) + 프로토콜 수수료(0.5%) + 거래 수수료(1%) 합산 |
| 세부 내역 | 거래 수수료 1% 중 0.5%는 $FYRST 바이백, 0.5%는 환불 풀 |
| 모니터링 주기 | 일일 |

### 4.7 추가 모니터링 지표

| 지표 | 모니터링 주기 | 설명 |
|------|-------------|------|
| API 응답 시간 (p95) | 실시간 | 500ms 초과 시 경고 |
| API 에러율 | 실시간 | 5xx 에러 1% 초과 시 경고 |
| WebSocket 활성 연결 수 | 실시간 | 서버 용량 모니터링 |
| DB 쿼리 성능 | 일일 | 느린 쿼리 식별 |
| Redis 메모리 사용률 | 일일 | 80% 초과 시 경고 |
| RPC 요청량/에러율 | 일일 | Helius/QuickNode 할당량 모니터링 |

---

## 5. 스케일링 고려사항

### 5.1 Railway 플랜 업그레이드 기준

| 지표 | 현재 플랜 한계 | 업그레이드 시점 | 조치 |
|------|---------------|----------------|------|
| API 메모리 사용량 | 512MB (Starter) | 400MB 지속 초과 시 | Pro 플랜 업그레이드 (8GB) |
| DB 저장 용량 | 1GB (Starter) | 800MB 도달 시 | Pro 플랜 또는 외부 PostgreSQL |
| DB 동시 연결 수 | 20 (Starter) | 15 연결 지속 초과 시 | 연결 풀링 도입 또는 플랜 업그레이드 |
| Redis 메모리 | 256MB (Starter) | 200MB 도달 시 | 키 만료 정책 최적화 또는 업그레이드 |
| 대역폭 | 5GB/월 (Starter) | 4GB 도달 시 | Pro 플랜 업그레이드 |

### 5.2 PostgreSQL 스케일링

**단기 최적화 (DAU 2,000 이하)**

- 인덱스 최적화: trades 테이블의 created_at + token_mint 복합 인덱스
- 쿼리 최적화: N+1 쿼리 제거, 배치 조회 적용
- 연결 풀링: Prisma 기본 연결 풀 크기 조정

**중기 조치 (DAU 2,000~10,000)**

- 읽기 전용 리플리카 도입
- 거래 내역 테이블 파티셔닝 (created_at 기준 월별)
- 외부 관리형 PostgreSQL 이전 (Supabase, Neon 등)

**장기 조치 (DAU 10,000 이상)**

- 실시간 데이터와 분석 데이터 분리 (OLTP/OLAP)
- 시계열 데이터 전용 저장소 도입 (가격 이력 등)

### 5.3 Redis 스케일링

**메모리 최적화**

- BullMQ 작업 완료 후 자동 삭제 설정 (removeOnComplete, removeOnFail)
- 캐시 키 TTL 설정: API 캐시 60초, 배포자 평판 300초
- 불필요한 키 정리 cron 설정

**스케일 아웃 시점**

- Redis 메모리 사용률 80% 지속 초과 시
- BullMQ 작업 큐 지연 5초 이상 지속 시
- 조치: Redis 인스턴스 메모리 업그레이드 또는 키 샤딩

### 5.4 Solana RPC 스케일링

| 상황 | 조치 |
|------|------|
| Helius 무료 티어 한도 도달 | Helius 유료 플랜 업그레이드 (Builder 이상) |
| RPC 응답 시간 500ms 이상 지속 | QuickNode 백업 RPC로 자동 전환 |
| 특정 RPC 프로바이더 장애 | 멀티 RPC 로드밸런싱 (Helius + QuickNode + 공용 RPC) |
| 초당 요청 50건 이상 필요 | 전용 RPC 노드 검토 (Helius Dedicated, Triton) |

### 5.5 프론트엔드 스케일링

- Vercel은 자동 스케일링이 적용되므로 별도 조치가 불필요합니다.
- Edge Functions 활용으로 글로벌 지연 시간을 최소화합니다.
- ISR(Incremental Static Regeneration) 적용으로 토큰 목록 페이지 성능을 최적화합니다.
- 정적 자산은 Vercel CDN에서 자동 서빙됩니다.

---

## 6. 긴급 대응 절차

### 6.1 러그 탐지 수동 오버라이드

자동 러그 탐지 시스템이 실패하거나, 수동 개입이 필요한 경우의 절차입니다.

**자동 탐지 실패 시 수동 러그 판정 기준:**

- 배포자가 총 공급량의 30% 이상을 한 트랜잭션에서 매도
- 배포자가 유동성 풀에서 대량 인출 (본딩커브 파괴)
- 배포자 지갑에서 생성된 토큰의 대량 이동 후 외부 DEX 매도
- 다수의 사용자 보고 (3건 이상의 독립적 보고)

**수동 환불 트리거 절차:**

```
1. 인시던트 확인
   - 해당 토큰 mint 주소 확인
   - 온체인 트랜잭션 분석 (Solscan/Solana Explorer)
   - 배포자 행동 패턴 확인

2. 내부 승인
   - 최소 2명의 팀원이 러그 판정에 동의
   - 판정 근거 문서화 (트랜잭션 해시, 스크린샷)

3. 수동 환불 실행
   - 백엔드 관리자 API를 통해 환불 트리거
   - POST /api/admin/refunds/trigger
   - Body: { "tokenMint": "<mint_address>", "reason": "<판정 근거>" }

4. 검증
   - 환불 트랜잭션 온체인 확인
   - 모든 바이어의 refund status가 completed인지 확인
   - 텔레그램 알림 수신 확인

5. 사후 처리
   - 배포자 평판 점수 F등급으로 하향
   - 인시던트 로그 작성
   - 사용자 커뮤니티 공지 (필요 시)
```

### 6.2 거래 일시 중단 (Trading Pause)

프로토콜 취약점 발견 또는 비정상적 활동 감지 시 거래를 일시 중단하는 절차입니다.

**트리거 조건:**

- 스마트 컨트랙트 취약점 보고/발견
- 비정상적 거래 패턴 감지 (봇 공격, 가격 조작 등)
- RPC 인프라 대규모 장애로 정상 거래 불가

**중단 절차:**

```
1. 즉시 조치 (15분 이내)
   - 프론트엔드 기능 플래그 비활성화
     NEXT_PUBLIC_FEATURE_TRADING=false
   - Vercel 재배포 (환경 변수 변경 후 즉시 배포)

2. 사용자 공지
   - 트위터:
     "FYRST trading is temporarily paused for maintenance.
      All funds in escrow are secure. We will provide an update within [X] hours."
   - 텔레그램/디스코드: 동일 내용 게시

3. 원인 분석 및 수정
   - 기술팀 긴급 회의
   - 원인 파악 -> 수정 -> 테스트

4. 재개
   - 기능 플래그 재활성화
     NEXT_PUBLIC_FEATURE_TRADING=true
   - Vercel 재배포
   - 정상화 확인 (스모크 테스트)

5. 사후 공지
   - 트위터:
     "Trading has resumed on FYRST.
      Issue: [간략 설명]
      Resolution: [조치 내용]
      All escrowed funds remained secure throughout."
   - 텔레그램/디스코드: 동일 내용 게시
```

### 6.3 긴급 환불 (Emergency Refund)

에스크로 자금의 안전이 위협받는 상황에서의 대량 환불 절차입니다.

**트리거 조건:**

- 에스크로 컨트랙트 취약점으로 자금 유출 위험
- 프로토콜 전체에 영향을 미치는 치명적 버그

**절차:**

```
1. 거래 즉시 중단 (섹션 6.2 절차 실행)

2. 영향 범위 파악
   - 영향받는 에스크로 계정 목록 추출
   - 각 에스크로의 잔액 및 바이어 목록 확인
   - 총 환불 대상 금액 산정

3. 환불 실행
   - 방법 A (자동): 관리자 API를 통한 배치 환불
     POST /api/admin/refunds/emergency-batch
     Body: { "tokenMints": ["<mint1>", "<mint2>", ...], "reason": "<사유>" }

   - 방법 B (수동): 온체인 직접 실행
     프로그램 업그레이드 권한으로 긴급 환불 인스트럭션 실행
     각 에스크로 PDA에서 바이어에게 직접 SOL 전송

4. 검증
   - 모든 환불 트랜잭션 온체인 확인
   - 바이어별 수령 금액 대조
   - 미환불 건 0건 확인

5. 커뮤니티 공지
   - 상황 설명, 영향 범위, 조치 내용, 환불 현황
   - 후속 일정 안내

6. 사후 분석
   - 근본 원인 분석 (RCA)
   - 재발 방지 대책 수립 및 적용
   - 투명한 사후 보고서 게시
```

### 6.4 인프라 장애 대응

**Railway 서비스 다운**

```
1. Railway 상태 확인: status.railway.app
2. 대안:
   - 사전 준비된 Docker 이미지로 대체 호스팅 (Fly.io, Render)
   - 또는 Railway 복구 대기 (30분 이내 예상 시)
3. 사용자 공지: "Backend maintenance in progress. Funds are safe."
```

**PostgreSQL 장애**

```
1. Railway PostgreSQL 대시보드 확인
2. 연결 실패 시:
   - Railway 자동 복구 대기 (10분)
   - 복구 안 될 경우: 최근 백업에서 복원
3. 데이터 정합성 확인:
   - 온체인 데이터와 DB 데이터 비교
   - 불일치 시 온체인 데이터 기준으로 DB 재동기화
```

**Redis 장애**

```
1. Railway Redis 대시보드 확인
2. Redis 장애 시 영향:
   - BullMQ 작업 큐 중단 -> 환불 처리 지연 가능
   - 캐시 무효화 -> API 응답 속도 저하
3. 대응:
   - Redis 재시작
   - 복구 안 될 경우: 새 Redis 인스턴스 생성 후 연결
   - BullMQ 미처리 작업 재실행
```

### 6.5 긴급 연락망

| 역할 | 담당 | 연락처 | 1차 대응 범위 |
|------|------|--------|-------------|
| 기술 리드 | [이름] | [연락처] | P0/P1 전체 |
| 블록체인 엔지니어 | [이름] | [연락처] | 스마트 컨트랙트, 온체인 |
| 백엔드 엔지니어 | [이름] | [연락처] | API, DB, Redis |
| 프론트엔드 엔지니어 | [이름] | [연락처] | 웹사이트, 기능 플래그 |
| 마케팅/커뮤니티 | [이름] | [연락처] | 사용자 소통, 공지 |

---

## 7. 소셜 미디어 포스팅 스케줄

### 7.1 런칭 전후 스케줄 (D-7 ~ D+14)

이 스케줄은 marketing-copy-en.md / marketing-copy-kr.md의 콘텐츠를 기반으로 합니다.

**D-7 ~ D-5: 사전 준비**

| 일자 | 작업 | 상세 |
|------|------|------|
| D-7 | 계정 세팅 | 트위터 프로필 이미지(Sentry), 헤더 이미지, 바이오 설정 (바이오 A안 사용) |
| D-7 | 콘텐츠 준비 | 포스트 1~10 최종 검수 및 스케줄링 도구 등록 |
| D-6 | 타겟 계정 리스트업 | 솔라나 인플루언서, 디젠 커뮤니티, 러그 피해 경험 공유 계정 50개 선별 |
| D-6 | 팔로우 시작 | 타겟 계정 팔로우 + 순수 참여 리플라이 (홍보 아님) |
| D-5 | 티저 게시 | "Something is coming to Solana." 단문 게시 (제품명 미공개) |

**D-4 ~ D-1: 문제 인식 단계 (포스트 1~3)**

| 일자 | 콘텐츠 | 시간 (UTC / KST) | 소스 |
|------|--------|-------------------|------|
| D-4 | 포스트 1: 95% 러그 통계 | 14:00 UTC / 23:00 KST | 스레드 포스트 1 (EN) |
| D-3 | 포스트 2: $300M 수수료 | 14:00 UTC / 23:00 KST | 스레드 포스트 2 (EN) |
| D-2 | 포스트 3: 디젠 손실 데이터 | 16:00 UTC / 01:00 KST | 스레드 포스트 3 (EN) |
| D-1 | 휴식일 | - | 포스팅 없음. 인게이지먼트 확인 |

**D-Day ~ D+2: 솔루션 시사 (포스트 4~6)**

| 일자 | 콘텐츠 | 시간 (UTC / KST) | 소스 |
|------|--------|-------------------|------|
| D-Day | 포스트 4: 에스크로 질문 | 14:00 UTC / 23:00 KST | 스레드 포스트 4 (EN) |
| D+1 | 포스트 5: 평판 추적 | 14:00 UTC / 23:00 KST | 스레드 포스트 5 (EN) |
| D+2 | 포스트 6: 설계 선택 | 16:00 UTC / 01:00 KST | 스레드 포스트 6 (EN) |

**D+3 ~ D+5: 제품 공개 (포스트 7~9)**

| 일자 | 콘텐츠 | 시간 (UTC / KST) | 소스 |
|------|--------|-------------------|------|
| D+3 | 포스트 7: FYRST 소개 (이름 + URL 최초 공개) | 14:00 UTC / 23:00 KST | 스레드 포스트 7 (EN) |
| D+3 | 텔레그램/디스코드 런칭 공지 | 포스트 7 직후 | 커뮤니티 공지 (EN + KR 동시) |
| D+4 | 포스트 8: 작동 방식 | 14:00 UTC / 23:00 KST | 스레드 포스트 8 (EN) |
| D+5 | 포스트 9: 평판 시스템 | 14:00 UTC / 23:00 KST | 스레드 포스트 9 (EN) |

**D+6: CTA**

| 일자 | 콘텐츠 | 시간 (UTC / KST) | 소스 |
|------|--------|-------------------|------|
| D+6 | 포스트 10: 라이브 CTA | 14:00 UTC / 23:00 KST | 스레드 포스트 10 (EN) |

**D+7 ~ D+14: 후속 운영**

| 일자 | 콘텐츠 | 시간 (UTC / KST) | 소스 |
|------|--------|-------------------|------|
| D+7 | 프로토콜 실적 공유 | 14:00 UTC / 23:00 KST | 트윗 템플릿 1 (EN) |
| D+8 | 커뮤니티 반응 인용 RT | 14:00 UTC / 23:00 KST | 사용자 긍정 피드백 원문 인용 |
| D+9 | 배포자 평판 하이라이트 | 14:00 UTC / 23:00 KST | 트윗 템플릿 2 (EN) |
| D+10 | 구조 비교 (pump.fun vs FYRST) | 16:00 UTC / 01:00 KST | 트윗 템플릿 4 (EN) |
| D+11 | 환불 성공 사례 (발생 시) | 14:00 UTC / 23:00 KST | 트윗 템플릿 3 (EN) |
| D+12 | 배포자 대상 CTA | 14:00 UTC / 23:00 KST | 트윗 템플릿 5 (EN) |
| D+13 | 휴식일 / AMA 예고 | - | AMA 일정 공지 |
| D+14 | Twitter Spaces AMA (30-45분) | 15:00 UTC / 00:00 KST | 라이브 |

### 7.2 지속 운영 포스팅 스케줄 (D+15 이후)

**주간 포스팅 패턴 (반복)**

| 요일 | 콘텐츠 유형 | 시간 (UTC / KST) | 소스 |
|------|-----------|-------------------|------|
| 월요일 | 프로토콜 주간 실적 | 14:00 UTC / 23:00 KST | 트윗 템플릿 1 (수치 업데이트) |
| 화요일 | 배포자/바이어 하이라이트 | 14:00 UTC / 23:00 KST | 트윗 템플릿 2 또는 3 |
| 수요일 | 교육 콘텐츠 (구조 설명, FAQ) | 16:00 UTC / 01:00 KST | 신규 작성 |
| 목요일 | 커뮤니티 인용 RT 또는 휴식일 | 14:00 UTC / 23:00 KST | 사용자 콘텐츠 |
| 금요일 | 구조 비교 또는 배포자 CTA | 14:00 UTC / 23:00 KST | 트윗 템플릿 4 또는 5 |
| 토요일 | 휴식일 | - | 포스팅 없음 |
| 일요일 | 휴식일 | - | 포스팅 없음 |

**월간 특별 콘텐츠**

| 주기 | 콘텐츠 | 설명 |
|------|--------|------|
| 매월 1주 | 월간 프로토콜 리포트 | 핵심 지표 + 배포자 평판 분포 + 환불 현황 |
| 매월 2주 | Twitter Spaces AMA | 30-45분, 주제: 업데이트, 로드맵, Q&A |
| 매월 3주 | 기술 심층 분석 | 에스크로 작동 원리, 크로스월렛 추적 등 스레드 |
| 매월 4주 | 커뮤니티 회고 | 월간 하이라이트, 사용자 피드백 요약 |

### 7.3 한국어 계정 운영 (별도 운영 시)

한국어 전용 트위터 계정 또는 텔레그램 채널을 운영할 경우, 영문 포스트 게시 후 6시간 이내에 한국어 버전을 게시합니다. marketing-copy-kr.md의 콘텐츠를 사용하되, 직역이 아닌 한국 크립토 커뮤니티의 어투에 맞게 조정합니다.

| 영문 포스트 시간 | 한국어 포스트 시간 | 비고 |
|----------------|-----------------|------|
| 14:00 UTC (23:00 KST) | 06:00 UTC (15:00 KST, 다음 날) | 아시아 오후 타겟 |
| 16:00 UTC (01:00 KST) | 06:00 UTC (15:00 KST, 당일) | 아시아 오후 타겟 |

### 7.4 포스팅 운영 규칙

- 하루 최대 1개 메인 포스트 (예외: 런칭일, 긴급 공지)
- 포스트 간 최소 20시간 간격 유지
- 리플라이/인용 RT는 메인 포스트와 별도 (하루 3~5개 허용)
- 모든 포스트에 이모지 사용 금지
- 가격 예측, 수익 보장 언급 절대 금지
- 경쟁 프로젝트 비방 금지 (사실 기반 비교만 허용)
- 스레드 형태의 교육 콘텐츠는 전체를 한 번에 게시
- 개별 메인 포스트는 스레드로 연결하지 않음

---
